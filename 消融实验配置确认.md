# æ¶ˆèå®éªŒé…ç½®ç¡®è®¤

## âœ… é…ç½®æ£€æŸ¥ç»“æœ

### å½“å‰å®éªŒï¼š`no_dual_projection`

è¿è¡Œ `sh examples/run_umc.sh` æˆ–ä½¿ç”¨ `--ablation_experiment no_dual_projection` æ—¶ï¼Œä»¥ä¸‹ç»„ä»¶**éƒ½å·²æ­£ç¡®å…³é—­**ï¼š

---

## ğŸ“‹ ç»„ä»¶çŠ¶æ€ç¡®è®¤

### âœ… å·²å…³é—­çš„ç»„ä»¶

| ç»„ä»¶ | é…ç½®æ–‡ä»¶çŠ¶æ€ | ä»£ç é€»è¾‘ | ç¡®è®¤ |
|------|------------|---------|------|
| **å¤šå±‚Cross-Attention** | `enable_cross_attention: False` | `UMC.py:474-482` æœ‰å¼€å…³æ§åˆ¶ | âœ… å·²å…³é—­ |
| **ç‰¹å¾äº¤äº’å±‚** | `enable_feature_interaction: False` | `UMC.py:534-545` æœ‰å¼€å…³æ§åˆ¶ | âœ… å·²å…³é—­ |
| **é—¨æ§èåˆ** | `enable_gated_fusion: False` | `UMC.py:547-553` æœ‰å¼€å…³æ§åˆ¶ | âœ… å·²å…³é—­ |
| **å¯¹æ¯”å­¦ä¹ æŸå¤±** | `enable_contrastive_loss: False` | `UMC.py:587-592` æœ‰å¼€å…³æ§åˆ¶ | âœ… å·²å…³é—­ |
| **åˆ›æ–°ç‚¹ä¸€ï¼ˆåŒæŠ•å½±ï¼‰** | `enable_video_dual: False`<br>`enable_audio_dual: False` | `UMC.py:449-458` æœ‰å¼€å…³æ§åˆ¶ | âœ… å·²å…³é—­ |

### âœ… å·²å¼€å¯çš„ç»„ä»¶

| ç»„ä»¶ | é…ç½®æ–‡ä»¶çŠ¶æ€ | è¯´æ˜ |
|------|------------|------|
| **åˆ›æ–°ç‚¹äºŒï¼ˆæ–‡æœ¬å¼•å¯¼æ³¨æ„åŠ›ï¼‰** | `enable_text_guided_attention: True`<br>`enable_self_attention: True` | âœ… å·²å¼€å¯ |
| **åˆ›æ–°ç‚¹ä¸‰ï¼ˆæ¸è¿›å¼å­¦ä¹ ï¼‰** | `enable_progressive_learning: True`<br>`enable_clustering_optimization: True` | âœ… å·²å¼€å¯ |

---

## ğŸ” ä»£ç é€»è¾‘éªŒè¯

### 1. å¤šå±‚Cross-Attentionï¼ˆå·²å…³é—­ï¼‰

**ä½ç½®**ï¼š`UMC.py` ç¬¬474-482è¡Œ

```python
if self.enable_cross_attention:
    for layer in self.cross_attn_video_layers:
        x_video, _ = layer(x_video, video_seq_t, video_seq_t)
    for layer in self.cross_attn_audio_layers:
        x_audio, _ = layer(x_audio, audio_seq_t, audio_seq_t)
else:
    # è·³è¿‡Cross-Attentionï¼Œç›´æ¥ä½¿ç”¨åŸå§‹ç‰¹å¾
    x_video = video_seq_t
    x_audio = audio_seq_t
```

**ç¡®è®¤**ï¼šâœ… å½“ `enable_cross_attention=False` æ—¶ï¼Œä¼šè·³è¿‡Cross-Attentionï¼Œç›´æ¥ä½¿ç”¨åŸå§‹ç‰¹å¾ã€‚

---

### 2. ç‰¹å¾äº¤äº’å±‚ï¼ˆå·²å…³é—­ï¼‰

**ä½ç½®**ï¼š`UMC.py` ç¬¬534-545è¡Œ

```python
if self.enable_feature_interaction:
    interaction_input = torch.stack([text_bert_proj, text_video_enh_pooled, text_audio_enh_pooled], dim=1)
    interaction_input = interaction_input.transpose(0, 1)
    
    interacted_features, _ = self.feature_interaction(interaction_input, interaction_input, interaction_input)
    interacted_features = interacted_features.transpose(0, 1)
    
    # åˆ†ç¦»äº¤äº’åçš„ç‰¹å¾
    text_bert_proj = interacted_features[:, 0]
    text_video_enh_pooled = interacted_features[:, 1]
    text_audio_enh_pooled = interacted_features[:, 2]
# else: è·³è¿‡ç‰¹å¾äº¤äº’ï¼Œç›´æ¥ä½¿ç”¨æ± åŒ–åçš„ç‰¹å¾
```

**ç¡®è®¤**ï¼šâœ… å½“ `enable_feature_interaction=False` æ—¶ï¼Œä¼šè·³è¿‡ç‰¹å¾äº¤äº’å±‚ï¼Œç›´æ¥ä½¿ç”¨æ± åŒ–åçš„ç‰¹å¾ã€‚

---

### 3. é—¨æ§èåˆï¼ˆå·²å…³é—­ï¼‰

**ä½ç½®**ï¼š`UMC.py` ç¬¬547-553è¡Œ

```python
if self.enable_gated_fusion:
    enhanced_text = self.gated_fusion(text_bert_proj, text_video_enh_pooled, text_audio_enh_pooled)
else:
    # ç®€å•æ‹¼æ¥èåˆ
    enhanced_text = torch.cat([text_bert_proj, text_video_enh_pooled, text_audio_enh_pooled], dim=-1)
    # éœ€è¦å°†æ‹¼æ¥åçš„ç‰¹å¾æŠ•å½±å›base_dimç»´åº¦
    enhanced_text = self.fusion_layer(enhanced_text)
```

**ç¡®è®¤**ï¼šâœ… å½“ `enable_gated_fusion=False` æ—¶ï¼Œä¼šä½¿ç”¨ç®€å•æ‹¼æ¥èåˆï¼Œè€Œä¸æ˜¯é—¨æ§èåˆã€‚

---

### 4. å¯¹æ¯”å­¦ä¹ æŸå¤±ï¼ˆå·²å…³é—­ï¼‰

**ä½ç½®**ï¼š`UMC.py` ç¬¬585-592è¡Œ

```python
# å¯¹æ¯”å­¦ä¹ ç‰¹å¾å’ŒæŸå¤± - æ¶ˆèå®éªŒæ§åˆ¶
contrastive_loss = None
if self.enable_contrastive_loss:
    contrastive_features = self.contrastive_proj(features)
    # è®¡ç®—å¯¹æ¯”å­¦ä¹ æŸå¤±
    if labels is not None:
        contrastive_loss = self.contrastive_loss(contrastive_features, labels)
# else: è·³è¿‡å¯¹æ¯”å­¦ä¹ æŸå¤±
```

**ç¡®è®¤**ï¼šâœ… å½“ `enable_contrastive_loss=False` æ—¶ï¼Œä¼šè·³è¿‡å¯¹æ¯”å­¦ä¹ æŸå¤±ï¼Œ`contrastive_loss` ä¿æŒä¸º `None`ã€‚

---

### 5. åˆ›æ–°ç‚¹ä¸€ï¼ˆåŒæŠ•å½±ï¼‰ï¼ˆå·²å…³é—­ï¼‰

**ä½ç½®**ï¼š`UMC.py` ç¬¬449-458è¡Œ

```python
# 2. åˆ›æ–°ç‚¹ä¸€ï¼šè§†é¢‘åŒæŠ•å½±å¤„ç†ï¼ˆConFEDEï¼‰- æ¶ˆèå®éªŒæ§åˆ¶
if self.enable_video_dual:
    video_seq = self.video_dual_projector(video_seq)
# else: è·³è¿‡è§†é¢‘åŒæŠ•å½±ï¼Œç›´æ¥ä½¿ç”¨åŸå§‹è§†é¢‘ç‰¹å¾

# 3. åˆ›æ–°ç‚¹ä¸€ï¼šéŸ³é¢‘åŒæŠ•å½±å¤„ç†ï¼ˆConFEDEï¼‰- æ¶ˆèå®éªŒæ§åˆ¶  
if self.enable_audio_dual:
    audio_seq = self.audio_dual_projector(audio_seq)
# else: è·³è¿‡éŸ³é¢‘åŒæŠ•å½±ï¼Œç›´æ¥ä½¿ç”¨åŸå§‹éŸ³é¢‘ç‰¹å¾
```

**ç¡®è®¤**ï¼šâœ… å½“ `enable_video_dual=False` å’Œ `enable_audio_dual=False` æ—¶ï¼Œä¼šè·³è¿‡åŒæŠ•å½±ï¼Œç›´æ¥ä½¿ç”¨åŸå§‹ç‰¹å¾ã€‚

---

## ğŸ“Š é…ç½®æ–‡ä»¶ä½ç½®

### 1. `configs/umc_MIntRec.py` ç¬¬167-198è¡Œ

```python
elif experiment_name == 'no_dual_projection':
    config = default_config.copy()
    config.update({
        # åˆ›æ–°ç‚¹ä¸€ï¼šå…³é—­
        'enable_dual_projection': False,
        'enable_video_dual': False,
        'enable_audio_dual': False,
        
        # åˆ›æ–°ç‚¹äºŒï¼šå¼€å¯
        'enable_text_guided_attention': True,
        'enable_self_attention': True,
        
        # åˆ›æ–°ç‚¹ä¸‰ï¼šå¼€å¯
        'enable_progressive_learning': True,
        'enable_clustering_optimization': True,
        
        # åŸºç¡€ç»„ä»¶ï¼šå…³é—­
        'enable_cross_attention': False,
        'enable_feature_interaction': False,
        'enable_gated_fusion': False,
        'enable_contrastive_loss': False,
    })
```

### 2. `run.py` ç¬¬137-152è¡Œ

```python
'no_dual_projection': {
    'enable_video_dual': False,
    'enable_audio_dual': False,
    'enable_text_guided_attention': True,
    'enable_self_attention': True,
    'enable_gated_fusion': False,
    'enable_cross_attention': False,
    'enable_feature_interaction': False,
    'enable_contrastive_loss': False,
    'enable_clustering_optimization': True,
    'enable_progressive_learning': True,
    ...
}
```

---

## âœ… æœ€ç»ˆç¡®è®¤

### æ‰€æœ‰ç»„ä»¶éƒ½å·²æ­£ç¡®é…ç½®

1. âœ… **å¤šå±‚Cross-Attention**ï¼šå·²å…³é—­
2. âœ… **ç‰¹å¾äº¤äº’å±‚**ï¼šå·²å…³é—­
3. âœ… **é—¨æ§èåˆ**ï¼šå·²å…³é—­
4. âœ… **å¯¹æ¯”å­¦ä¹ æŸå¤±**ï¼šå·²å…³é—­
5. âœ… **åˆ›æ–°ç‚¹ä¸€ï¼ˆåŒæŠ•å½±ï¼‰**ï¼šå·²å…³é—­

### å·²å¼€å¯çš„ç»„ä»¶

1. âœ… **åˆ›æ–°ç‚¹äºŒï¼ˆæ–‡æœ¬å¼•å¯¼æ³¨æ„åŠ›ï¼‰**ï¼šå·²å¼€å¯
2. âœ… **åˆ›æ–°ç‚¹ä¸‰ï¼ˆæ¸è¿›å¼å­¦ä¹ ï¼‰**ï¼šå·²å¼€å¯

---

## ğŸš€ è¿è¡Œç¡®è®¤

**ç°åœ¨è¿è¡Œ `sh examples/run_umc.sh` æ—¶ï¼Œæ‰€æœ‰æŒ‡å®šçš„ç»„ä»¶éƒ½å·²å…³é—­ï¼**

å®éªŒå°†ï¼š
- âŒ ä¸ä½¿ç”¨å¤šå±‚Cross-Attention
- âŒ ä¸ä½¿ç”¨ç‰¹å¾äº¤äº’å±‚
- âŒ ä¸ä½¿ç”¨é—¨æ§èåˆ
- âŒ ä¸ä½¿ç”¨å¯¹æ¯”å­¦ä¹ æŸå¤±
- âŒ ä¸ä½¿ç”¨åˆ›æ–°ç‚¹ä¸€ï¼ˆåŒæŠ•å½±ï¼‰
- âœ… ä½¿ç”¨åˆ›æ–°ç‚¹äºŒï¼ˆæ–‡æœ¬å¼•å¯¼æ³¨æ„åŠ›ï¼‰
- âœ… ä½¿ç”¨åˆ›æ–°ç‚¹ä¸‰ï¼ˆæ¸è¿›å¼å­¦ä¹ ï¼‰

---

## ğŸ“ æ³¨æ„äº‹é¡¹

### ä»ç„¶å¯ç”¨çš„åŸºç¡€ç»„ä»¶

ä»¥ä¸‹åŸºç¡€ç»„ä»¶ä»ç„¶å¯ç”¨ï¼ˆè¿™äº›æ˜¯åŸºç¡€æ¶æ„ï¼Œé€šå¸¸ä¸åº”è¯¥å…³é—­ï¼‰ï¼š

1. **BERTæ–‡æœ¬ç¼–ç å™¨**ï¼šå§‹ç»ˆå¯ç”¨ï¼ˆåŸºç¡€ç‰¹å¾æå–å™¨ï¼‰
2. **Transformerç¼–ç å™¨**ï¼ˆv_encoder, a_encoderï¼‰ï¼šå§‹ç»ˆå¯ç”¨ï¼ˆåŸºç¡€ç‰¹å¾æå–å™¨ï¼‰
3. **ç‰¹å¾æŠ•å½±å±‚**ï¼šå§‹ç»ˆå¯ç”¨ï¼ˆåŸºç¡€æ¶æ„ï¼‰
4. **å…±äº«åµŒå…¥å±‚**ï¼šå§‹ç»ˆå¯ç”¨ï¼ˆåŸºç¡€æ¶æ„ï¼‰

è¿™äº›æ˜¯æ¨¡å‹çš„åŸºç¡€æ¶æ„ï¼Œå…³é—­å®ƒä»¬ä¼šå¯¼è‡´æ¨¡å‹æ— æ³•æ­£å¸¸å·¥ä½œã€‚

---

**æ€»ç»“ï¼šæ‰€æœ‰æŒ‡å®šçš„ç»„ä»¶éƒ½å·²æ­£ç¡®å…³é—­ï¼Œå¯ä»¥æ”¾å¿ƒè¿è¡Œå®éªŒï¼**








